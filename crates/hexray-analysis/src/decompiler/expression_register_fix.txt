    /// Creates a register variable.
    ///
    /// For x86-64, this normalizes partial register accesses to their 64-bit form:
    /// - al, ah, ax, eax → rax
    /// - bl, bh, bx, ebx → rbx
    /// - etc.
    ///
    /// The original size is preserved in the size field, which can be used
    /// to generate appropriate casts when needed.
    pub fn from_register(reg: &Register) -> Self {
        let reg_name = reg.name();
        let size_bytes = (reg.size / 8) as u8;

        // Normalize x86-64 partial registers to their 64-bit form
        let (normalized_name, original_size) = if matches!(reg.arch, Architecture::X86_64) {
            abi::normalize_x86_64_register(reg_name, size_bytes)
                .unwrap_or((reg_name, size_bytes))
        } else {
            (reg_name, size_bytes)
        };

        Self {
            kind: VarKind::Register(reg.id),
            name: normalized_name.to_string(),
            size: original_size,
        }
    }
